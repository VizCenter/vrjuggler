<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Christopher Just">
   <META NAME="Description" CONTENT="This file describes the file formats of the VRLib Configuration system.">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (X11; I; IRIX64 6.4 IP30) [Netscape]">
   <TITLE>VRLib Configuration File Formats</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">

<H2>
VRLib Configuration File Formats</H2>
This document discusses the formats used for the VRLib Configuration files.
It includes ChunkDesc files (which define the available types of ConfigChunks)
and Chunk files (containing lists of ConfigChunks).

<P>The Chunk and ChunkDesc files are plaintext ASCII files,
<H3>
I. Description of ChunkDesc (ConfigChunk Description) files.</H3>
A ChunkDesc file includes descriptions of different kinds of ConfigChunks.
It is a way to configure the configuration system itself. For example,
here are two entries that you might find in a ChunkDesc file:
<PRE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chunk flockobirds
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; port string 1 port "serial port address"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset double 3 offset "tracker coord offset from origin"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; baudrate int 1 baud "serial port rate"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chunk display
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name string 1 name "descriptive name"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; origin double 3 origin "other help text"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size int 2 size ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SGIpipe int 1 SGIpipe ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xdisplay string 1 xdisplay ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stereo bool 1 stereo ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lowerleft double 3 lowerleft ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lowerright double 3 lowerright ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; upperleft double 3 upperleft ""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end</PRE>
The first entry defines a chunk type called "flockobirds" that contains
three properties ("port", "offset", and "baudrate"). The second defines
a chunktype called "display" which contains 9 properties.

<P>Each property has a type - for example, the values that "port" can take
will be strings, such as "/dev/ttyd45", while baudrate will always have
integer values.

<P>It is possible for a property to have a set of values. For example,
the "display" chunk's "lowerleft", "lowerright", and "upperleft" properties
are meant to represent positions in 3d space. These can be represented
by a sequence of three doubles for the x, y, and z coordinates. The number
of values a property supports is listed directly to the right of the type
- the "3" in the line for "lowerleft", or the "1" for "stereo." If a property
might have a variable number of entries (perhaps as a list of active displays,
or such), use the number -1.

<P>The fourth word on each property line is the actual token to be used
to represent this property when reading/writing config files. Most often
this will be the same as the name of the property (which is used internally
for querying a ConfigChunk), but the options is provided to make the config
files more flexible or readable.

<P>The last thing on a property line is a help string. If the help string
contains spaces or is empty, it must be in quotes.

<P>For int type properties, there is also an optional set of enumeration
values, which can be placed between the token name and the help string.
For example:
<PRE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chunk C2Setup
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWalls int -1 ActiveWalls { front back left right top&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bottom } "list of walls to show"</PRE>
then in a config file, instead of having to say "ActiveWalls { 0 3 4 }"
you can say, more intuitively, "ActiveWalls { front right top }". Values
in an enum start at 0, but can also be explicitly stated: ActiveWalls int
-1 ActiveWalls { front=3 back left right=0 } ""

<P>then the values assigned to each enumeration item will be 3,4,5, and
0, from left to right. In addition to the explicitly listed properties,
every chunktype has a property called "type", which has a single string
value. This provides a way to query for the type of the ConfigChunk. For
our examples above, the values of the "type" property would be "flockobirds"
and "display", respectively. Once all the properties for a particular chunk
have been listed, the symbol "end" is used to close the description. Here's
the standard form of a ConfigDesc entry: chunk&nbsp;<typename><property1><type><numentries><token><property2>...
...&nbsp;<propertyn>... end&nbsp;<Typename>can be any string value (that
hasn't already been defined as a typename).&nbsp;<Propertyx>can be any
string, except "type" (and all the property names for a given chunk type
should be unique).&nbsp;<Numentries>is an integer, greater than 0 or -1.&nbsp;<Token>is
any string (although all tokens in a given chunk type should be unique).
A ChunkDesc file is simply zero or more of these entries, followed by a
final "end".
<H3>
II. Description of ConfigChunk files</H3>
A config file is zero or more ConfigChunk entries terminated with the word
"end". Here are some example chunks:
<PRE>display
&nbsp; name "c2 rear wall"
&nbsp; XDisplay ":0.0"
&nbsp; stereo false
&nbsp; sgipipe 1
&nbsp; size { 9 12 }
&nbsp; lowerleft { 3.4 6.555 9.9 }
&nbsp; origin { 3.3 1.0 5.5 }
&nbsp; end

display
&nbsp; name "c2 Front Wall"
&nbsp; XDisplay ":0.0"
&nbsp; stereo true
&nbsp; end

c2setup
&nbsp; c2width 3.3
&nbsp; walls { front left right top bottom }
&nbsp; c2height 3.5
&nbsp; end
End</PRE>

<PRE>- Notes on parsing:

Reserved words/tokens:

in Config files:
&nbsp;&nbsp; end
&nbsp;&nbsp; true
&nbsp;&nbsp; false
&nbsp;&nbsp; yes
&nbsp;&nbsp; no
in ChunkDesc files:
&nbsp;&nbsp; chunk
&nbsp;&nbsp; end
&nbsp;&nbsp; string
&nbsp;&nbsp; double
&nbsp;&nbsp; int&nbsp;
&nbsp;&nbsp; boolean
1. In order to have words that the parser will think are tokens interpreted&nbsp;
&nbsp;&nbsp; as strings, surround them with quotes ("").&nbsp; This is also necessary
&nbsp;&nbsp; in order to have strings with whitespace considered as single strings.
2. bug - there's no way to include quotes inside a quoted string. (Is this
&nbsp;&nbsp; possible in non-quoted strings?).</PRE>

</BODY>
</HTML>
