<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>

<title>Working with Description Files</title>

<body bgcolor="#ffffcc">

<!--NewPage-->
<h1><img src="juggler.gif" width="29" height="33"></img>Working with ConfigChunk description files</h1>

Vjcontrol includes the ability to view and edit the Chunk Description
files, allowing you to create new kinds of ConfigChunks or modify existing
Chunks.  Typically, there are two reasons you might want to do this:
<ol>
<li>You're an application writer, and you want your application to be
able to configure itself using the VR Juggler configuration mechanism.
You could create a new kind of ConfigChunk that contains information
specific to your application.
<li>You're developing a new component for VR Juggler - a device driver,
or something similar.  You would create a ConfigChunk to define the driver's 
configuration info, which could include things like serial port name and 
speed, calibration files, and so on.
</ol>

<p>
You can load and edit VR Juggler Chunk Description Files by clicking on the 
"Descriptions" tab of vjcontrol's main window.

<p>The Descriptions panel is similar to the <a href="ChunkDBPanel.html">
Configure panel</a>, without the side-by-side display of multiple files.

<p>
<img alt="Descriptions Panel picture" src="./gfx/DescDBPanel1.png"></img>

<p>
The ComboBox at the top of the panel lets you choose which of the
loaded description files to display (in this case, the file is called
``chunksDesc'').  Below that is a list of all the ChunkDescs defined
in the file.  Click on a name 
to select it.  You can double-click
on a name to view or edit the ChunkDesc.

<p>
There are six buttons along the side of the panel:

<ul>
<li>New - creates a new (empty) descriptions file.
<li>Load - loads a descriptions file.
<li>Save - save the descriptions file currently being viewed.  Note that this
button always opens a file dialog, so it's technically ``Save As...''
<li>Close - removes the currently viewed description file from memory.
<b>WARNING!</b> VjControl does not currently warn you if you close a
file without saving it.

<li>Remove - deletes all selected descriptions in the currently viewed file.
<li>Insert - inserts a new description.  Initially, a new description only
has one property - the instance name.

</ul>


<h2>The ChunkDesc editing window</h2>

Double-clicking on the name of a ChunkDesc brings up a new window, like
this:

<p>
<img alt="Description Editing Window" src="./gfx/DescFrame1.png"></img>
<p>

The uppermost part of the window displays basic information about the
ChunkDesc.  Every ChunkDesc has two identifiers: a descriptive name which
is used for GUI displays, and a shorter token, which is used in the file
format and internally by VR Juggler.  The name can be any short descriptive 
phrase; the token should be terse and may not contain spaces.
<p>
There is also a help string, which can be used to provide a general
one-line description of what the ChunkDesc is for.

<p>
The center of the ChunkDesc editing window displays a scrollable list of
all the properties that ConfigChunks using this description should have.
Every ChunkDesc includes a Name property, which is actually used to store
the instance name for ConfigChunks of that type.  The number and type of
other properties can vary.
<p>
Users can add a new property by pressing the "Insert" button at the bottom of 
the window.  Properties can be removed by selecting them (clicking on the 
background of the property's box) and then pressing the "Remove" button.

<p>
As with the ChunkDesc itself, each property has a descriptive name and
short token, as well as a help string.  Some properties can have multiple
values (e.g. a position with separate x, y, and z values); this can be
defined by entering the desired number of values in the "Number" box, or
by selecting the "Var Arguments" value, for a property with a variable
number of values.

<p>
Every property has a specific type of legal values (integers, strings, 
etc.); this is selected in the "Type" box.  The meanings of the different
types are explained in the <a href="chunkprimer.html">ConfigChunk 
Primer</a>.

<p>
If a property allows multiple values, it may be helpful to provide 
individual lables for each one.  For example, a "Window Size" parameter
may have values labeled "Width" and "Height".  To define labels, click
on the property's "Value Labels" button.  A window like this one will be
displayed:

<p>
<img src="./gfx/ValueLabels1.png" alt="Value labels editor window"></img>
<p>
The window contains one line for each value the property allows; in this case
we're labeling the individual values "width" and "height".  If the property
allows a variable number of values, the Value Label window will include
Insert and Remove buttons.

<p>
<h2>Properties with Enumerations</h2>

Sometimes, a property will have a fixed set of possible values (e.g.
"Shift" "Control" "Alt" "None" for keypress modifiers).  Selecting
the "Edit Enumerations" button for a property description will open a window 
which allows you to define the set of allowed values.  When VjControl
is displaying a Property with a set of enumerated values, it can present
the choices using a menu instead of requiring the user to type a value.
<p>
The enumerations feature can also be used to provide text names for
numeric or boolean values (e.g. assigning the string "NTSC" to the value 60,
and "PAL" to 50).

<h2>Properties that Reference or Embed ConfigChunks</h2>

Sometimes, a property of a ConfigChunk will be a reference to another
ConfigChunk.  For example, the ConfigChunk for a graphics window might
refer to a position input device to use for view frustum calculations.
<p>
To create a property of this type, select "Chunk" as the value type for
the property.  In place of the "Edit Enumerations" button, you'll see a
"Set Allowed Types" button.  This opens a small window which lets you 
select what kinds of ConfigChunks this property should be allowed to
point to.
<p>
Other times, it may be convenient to completely include a ConfigChunk
inside of a property, instead of referring to an external Chunk.  For
example, VR Juggler config files frequently do this to handle complex
data types such as keypresses with modifiers in the configuration of
its simulated input devices.  VjControl has special features to 
display a small "embedded" chunk as a single line inside a ConfigChunkFrame.
<p>
To create a property of this type, select "Embedded Chunk" as the value
type.  You'll see an "Inner Chunk Type" button in place of the "Edit
Enumerations" button.  This button opens a small window, similar to the
set allowed types window mentioned above (the difference is that this one
only allows you to select a single type of ConfigChunk).

<h2>Using DescHelp files</h2>

The help strings for chunks and properties aren't always sufficient to explain
the concept behind a given ConfigChunk, so VjControl includes a mechanism
to include more verbose documentation as an external HTML file.  These files
can be automatically displayed by VjControl when a user presses the help
button in the ConfigChunk editor window, or through the help menus, context-
sensitive help, etc.
<p>
Each "DescHelp" file should be named "<tt>token.html</tt>", where 
<tt>token</tt> is the token of the ChunkDesc it describes.  VjControl searches
for DescHelp files in several places:

<ul>
<li>Inside the VjControl binary itself
<li>In <tt>$VJ_BASE_DIR/share/vrjuggler/data/DescHelp</tt>
<li>In <tt>$HOME/.vjconfig/DescHelp</tt>
</ul

Consult any of these locations to see the preferred format of a DescHelp
HTML file.  The file itself can by any HTML, and can even include external
web links, but it should be noted that the HTML display panel used in 
VjControl (and supplied by Java Swing) does not always interpret complex
HTML correctly.

<br><br>
</body>


</html>


